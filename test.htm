<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIFF ä¸²æ¥æ¸¬è©¦</title>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; line-height: 1.6; }
        .box { border: 1px solid #ccc; padding: 15px; border-radius: 8px; background: #f9f9f9; }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
    </style>
</head>
<body>

    <h2>LINE LIFF åŸºç¤ä¸²æ¥æ¸¬è©¦</h2>
    
    <div class="box">
        <p><strong>ç³»çµ±ç‹€æ…‹ï¼š</strong> <span id="status">æº–å‚™è¼‰å…¥ä¸­...</span></p>
        <hr>
        <p id="profile-info">ç­‰å¾…å–å¾—è³‡æ–™...</p>
    </div>

    <script>
        // ä½ çš„ LIFF ID
        const LIFF_ID = "2009158441-00JwsNW0"; 

        async function testLiff() {
            try {
                document.getElementById('status').innerText = "é–‹å§‹åŸ·è¡Œ liff.init()...";
                
                // 1. åˆå§‹åŒ– LIFF
                await liff.init({ liffId: LIFF_ID });
                document.getElementById('status').innerText = "åˆå§‹åŒ–æˆåŠŸï¼æª¢æŸ¥ç™»å…¥ç‹€æ…‹...";

                // 2. æª¢æŸ¥æ˜¯å¦ç™»å…¥
                if (!liff.isLoggedIn()) {
                    document.getElementById('status').innerText = "å°šæœªç™»å…¥ï¼Œç³»çµ±å°‡è‡ªå‹•è·³è½‰...";
                    liff.login();
                    return;
                }

                // 3. å–å¾—ä½¿ç”¨è€…è³‡æ–™
                document.getElementById('status').innerText = "å·²ç™»å…¥ï¼æ­£åœ¨å–å¾—å€‹äººæˆæ¬Šè³‡æ–™...";
                const profile = await liff.getProfile();

                // 4. æˆåŠŸå°å‡ºè³‡æ–™
                document.getElementById('status').innerHTML = '<span class="success">ä¸²æ¥å¤§æˆåŠŸ ğŸ‰</span>';
                document.getElementById('profile-info').innerHTML = `
                    <b>ä½ çš„ LINE æš±ç¨±ï¼š</b> ${profile.displayName} <br>
                    <b>ä½ çš„ User IDï¼š</b> ${profile.userId}
                `;

            } catch (error) {
                // å¦‚æœå¤±æ•—ï¼ŒæŠŠçœŸå¯¦çš„éŒ¯èª¤è¨Šæ¯å°åœ¨ç•«é¢ä¸Š
                document.getElementById('status').innerHTML = `<span class="error">é€£ç·šå¤±æ•— âŒ</span>`;
                document.getElementById('profile-info').innerHTML = `
                    <span style="color:red;"><b>éŒ¯èª¤åŸå› ï¼š</b> ${error.message}</span><br><br>
                    <small>è«‹ç¢ºèªï¼š<br>1. ç¶²å€æ˜¯å¦ç‚º https é–‹é ­<br>2. æ­¤ç¶²å€æ˜¯å¦å·²å¡«å…¥ LINE å¾Œå°çš„ Endpoint URL</small>
                `;
                console.error("LIFF Error:", error);
            }
        }

        // åŸ·è¡Œæ¸¬è©¦
        testLiff();
    </script>

</body>
</html>
